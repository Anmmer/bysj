<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yinhai.bysj.datavisualization.mapper.read.StatisticsReadMapper">
    <select id="queryMaterialConsum" resultType="com.yinhai.bysj.datavisualization.entity.Total">
        SELECT to_char(INPUT_DATE, 'mm') as month,sum(NUM) as num
        FROM
             (SELECT cs.NUM, cs.INPUT_DATE, w.TYPE FROM CONSUMPTION_STATISTICS cs, WL w
              WHERE cs.ID = w.ID and w.TYPE = #{type})
        GROUP BY to_char(INPUT_DATE, 'mm')
        ORDER BY
            to_char( INPUT_DATE, 'mm' )
    </select>

    <select id="queryCountByType" resultType="com.yinhai.bysj.datavisualization.entity.PieChart">
        SELECT TYPE as name,COUNT(*) as value FROM WL GROUP BY TYPE
    </select>
</mapper>
